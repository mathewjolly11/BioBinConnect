# BioBinConnect - Complete Workflow Analysis Report

**Generated:** January 22, 2026  
**Project:** BioBinConnect Waste Management System  
**Database:** db_biobinconnect  
**Framework:** Django 6.0

---

## üìã Executive Summary

BioBinConnect is a comprehensive waste management platform connecting **Households**, **Collectors**, **Compost Managers**, **Farmers**, and **Admins** in a circular economy ecosystem. The system manages organic waste collection, composting, and distribution with integrated payment tracking and inventory management.

### System Architecture

- **5 User Roles:** Admin, Household, Collector, Compost Manager, Farmer
- **6 Django Apps:** MyApp (Admin), GuestApp, HouseholdApp, CollectorApp, CompostManagerApp, FarmerApp
- **26+ Database Tables** with complex relationships
- **Email System:** Console backend (dev) with SMTP fallback (production)

---

## üîÑ Complete Workflow Breakdown

### **1. GUEST/PUBLIC WORKFLOW**

#### **1.1 User Registration & Authentication**

**URL Pattern:** `/` (GuestApp)

**Available Actions:**

- **Landing Page:** `GET /` ‚Üí Guest homepage with service information
- **User Registration:** `GET/POST /signup/` ‚Üí Multi-role registration (Household, Collector, Farmer, Compost Manager)
- **Login:** `GET/POST /login/` ‚Üí Authentication with role-based redirection
- **Logout:** `POST /logout/` ‚Üí Session termination

**Registration Process:**

1. User selects role (Household/Collector/Farmer/Compost Manager)
2. Fills role-specific form with required documents:
   - **Household:** Name, Email, Phone, Address, Aadhaar Image, House Number, District, Location, Residents Association
   - **Collector:** Name, Email, Phone, Address, License Image
   - **Farmer:** Name, Email, Phone, Address, Aadhaar Image
   - **Compost Manager:** Name, Email, Phone, Address, License Number
3. Account created with `is_verified=True`, `is_active=True`, `account_status='Pending'`
4. Admin approval required before access

**Validation Features:**

- House number uniqueness validation (AJAX)
- Email uniqueness check
- Phone number format validation
- Document upload requirements

**Files Involved:**

- [`GuestApp/views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/GuestApp/views.py) - Authentication logic
- [`GuestApp/forms.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/GuestApp/forms.py) - Registration forms
- [`GuestApp/api_views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/GuestApp/api_views.py) - AJAX validation endpoints

---

### **2. ADMIN WORKFLOW**

#### **2.1 User Management**

**URL Pattern:** `/admin/` (MyApp)

**Core Functions:**

##### **User Approval Process**

- **View Pending Users:** `GET /admin/view_users/` ‚Üí Display all users with approval status
- **Approve User:** `POST /admin/approve_user/<user_id>/` ‚Üí Activate user account
- **Reject User:** `POST /admin/reject_user/<user_id>/` ‚Üí Deactivate user account
- **Bulk Approve:** `POST /admin/approve_all_users/` ‚Üí Approve all pending users
- **Bulk Reject:** `POST /admin/reject_all_users/` ‚Üí Reject all pending users
- **Edit User:** `GET/POST /admin/edit_user/<user_id>/` ‚Üí Modify user details
- **Change Password:** `POST /admin/change_user_password/<user_id>/` ‚Üí Reset user password
- **View Aadhaar:** `GET /admin/view_aadhaar/<user_id>/` ‚Üí Display uploaded documents

**Database Tables:**

- `guestapp_customuser` - Base user authentication
- `guestapp_household` - Household-specific data
- `guestapp_collector` - Collector-specific data
- `guestapp_farmer` - Farmer-specific data
- `guestapp_compostmanager` - Compost manager-specific data

#### **2.2 Location & Route Management**

##### **District Management**

- **Add District:** `GET/POST /admin/add_district/` ‚Üí Create new district
- **View Districts:** `GET /admin/view_districts/` ‚Üí List all districts
- **Edit District:** `GET/POST /admin/edit_district/<district_id>/` ‚Üí Modify district
- **Delete District:** `POST /admin/delete_district/<district_id>/` ‚Üí Remove district

##### **Location (Ward) Management**

- **Add Location:** `GET/POST /admin/add_location/` ‚Üí Create ward with district association
- **View Locations:** `GET /admin/view_locations/` ‚Üí List all wards
- **Edit Location:** `GET/POST /admin/edit_location/<location_id>/` ‚Üí Modify ward details
- **Delete Location:** `POST /admin/delete_location/<location_id>/` ‚Üí Remove ward

##### **Residents Association Management**

- **Add RA:** `GET/POST /admin/add_ra/` ‚Üí Create residents association
- **View RAs:** `GET /admin/view_ra/` ‚Üí List all associations
- **Edit RA:** `GET/POST /admin/edit_ra/<ra_id>/` ‚Üí Modify association
- **Delete RA:** `POST /admin/delete_ra/<ra_id>/` ‚Üí Remove association

##### **Route Management**

- **Add Route:** `GET/POST /admin/add_route/` ‚Üí Create collection route with house number range
- **View Routes:** `GET /admin/view_routes/` ‚Üí List all routes
- **Route Fields:**
  - Name (unique identifier)
  - Location (ward)
  - Start House Number
  - End House Number

**Database Tables:**

- `myapp_tbl_district` - Districts
- `myapp_tbl_location` - Wards with district FK
- `myapp_tbl_residentsassociation` - Associations with location FK
- `myapp_tbl_route` - Collection routes with location FK

#### **2.3 Collector Assignment**

**Assignment Workflow:**

- **Assign Collector:** `GET/POST /admin/assign_collector/` ‚Üí Assign collector to route and days
- **View Assignments:** `GET /admin/view_assignments/` ‚Üí List all collector-route assignments
- **Delete Assignment:** `POST /admin/delete_assignment/<assignment_id>/` ‚Üí Remove assignment

**Assignment Logic:**

- Select Collector (from approved collectors)
- Select Route (from available routes)
- Select Days of Week (Monday-Sunday, multiple selection)
- Unique constraint: `(collector, route, day_of_week)`

**Database Table:**

- `myapp_tbl_collectorassignment` - Collector-Route-Day mappings

**Example Data:**

```sql
-- Collector #1 assigned to Route #1 for all days
(Assign_id=1, collector_id=1, Route_id=1, day_of_week='Monday')
(Assign_id=2, collector_id=1, Route_id=1, day_of_week='Tuesday')
...
```

#### **2.4 Bin Type Management**

- **Add Bin Type:** `GET/POST /admin/add_bin_type/` ‚Üí Create bin type with capacity and price
- **View Bin Types:** `GET /admin/view_bin_types/` ‚Üí List all bin types
- **Edit Bin Type:** `GET/POST /admin/edit_bin_type/<bin_type_id>/` ‚Üí Modify bin details
- **Delete Bin Type:** `POST /admin/delete_bin_type/<bin_type_id>/` ‚Üí Remove bin type

**Bin Type Fields:**

- Name (e.g., "Large", "Medium")
- Capacity (kg)
- Price (‚Çπ)

**Database Table:**

- `myapp_tbl_bintype`

**Current Data:**

- Large: 50kg @ ‚Çπ100
- Medium: 25kg @ ‚Çπ50

#### **2.5 Waste Sales Management**

**URL Pattern:** `/admin/waste-sales/` (sales_views.py)

**Functions:**

- **View Waste Orders:** `GET /admin/waste-sales/` ‚Üí Display farmer waste purchase orders
- **Assign Collector:** `POST /admin/assign-collector/<order_id>/` ‚Üí Assign collector to deliver waste order
- **Stock Management:** `GET /admin/stock-management/` ‚Üí View waste inventory levels

**Workflow:**

1. Farmer places waste order
2. Admin assigns collector to fulfill order
3. System checks collector's available inventory
4. Creates `tbl_FarmerSupply` record linking order to collector's inventory
5. Updates delivery status

**Database Tables:**

- `myapp_tbl_order` - Farmer orders
- `myapp_tbl_orderitem` - Order line items
- `myapp_tbl_farmersupply` - Delivery assignments
- `myapp_tbl_wasteinventory` - Collector inventory

#### **2.6 Compost Sales Management**

**Functions:**

- **View Compost Orders:** `GET /admin/compost-sales/` ‚Üí Display farmer compost purchase orders
- **Update Delivery:** `POST /admin/update-delivery/<order_id>/` ‚Üí Update compost delivery status

**Delivery Statuses:**

- Pending
- Processing
- Shipped
- Delivered
- Cancelled

#### **2.7 Salary Management**

**URL Pattern:** `/admin/salaries/` (salary_views.py)

**Salary Calculation:**

##### **Collector Salaries**

- **Base Rate:** ‚Çπ5 per kg of waste collected
- **Calculation:** Total waste collected (from `tbl_CollectionRequest`) √ó ‚Çπ5
- **Payment Tracking:** `salary_paid` flag in `tbl_WasteInventory`

##### **Compost Manager Salaries**

- **Base Rate:** ‚Çπ10 per kg of compost produced
- **Calculation:** Total compost produced (from `tbl_CompostBatch`) √ó ‚Çπ10
- **Payment Tracking:** `salary_paid` flag in `tbl_CompostBatch`

**Salary Workflow:**

1. **View Salaries:** `GET /admin/salaries/` ‚Üí Display unpaid salaries for all roles
2. **Pay Salary:** `POST /admin/pay-salary/` ‚Üí Initiate payment
3. **Confirm Payment:** `POST /admin/pay-confirm/<user_type>/<user_id>/` ‚Üí Mark as paid and create transaction record

**Database Tables:**

- `myapp_tbl_paymenttransaction` - Payment records
- `myapp_tbl_wasteinventory` - Collector work tracking
- `myapp_tbl_compostbatch` - Manager work tracking

#### **2.8 Payment & Revenue Analytics**

**Payment Transactions:**

- **View Transactions:** `GET /admin/payment-transactions/` ‚Üí Display all payment transactions
- **Revenue Analytics:** `GET /admin/payment-revenue-analytics/` ‚Üí Financial dashboard

**Transaction Types:**

- **Household Payment** - Monthly waste pickup fees
- **Farmer Payment** - Waste/compost purchases
- **Collector Salary** - Collector payments
- **Manager Salary** - Compost manager payments
- **COD** - Cash on delivery payments

**Database Table:**

- `myapp_tbl_paymenttransaction` - All financial transactions

**Fields:**

- Transaction Type
- Amount
- Payment Method (UPI/Cash/Card)
- Transaction Date
- User Reference
- Transaction ID

#### **2.9 Reports & Analytics**

- **Reports Dashboard:** `GET /admin/reports/` ‚Üí Comprehensive analytics
- **Payment Report:** `GET /admin/payment_report/` ‚Üí Payment history
- **Export Report:** `GET /admin/export_payment_report/` ‚Üí Download payment data

**Report Metrics:**

- Total waste collected
- Total compost produced
- Revenue by source
- Pending payments
- User statistics

#### **2.10 System Settings**

- **Settings Page:** `GET/POST /admin/settings/` ‚Üí Configure system parameters

**Configurable Settings:**

- **Compost Conversion Ratio:** Waste to compost ratio (default: 4kg waste = 1kg compost)
- **Low Stock Threshold:** Warning level for inventory (default: 50kg)
- **Expiry Warning Days:** Days before expiry alert (default: 7 days)
- **Auto Unavailable Days:** Auto-mark waste unavailable after X days (default: 30 days)
- **Waste Price Per Kg:** Default waste selling price (default: ‚Çπ10/kg)

**Database Table:**

- `myapp_systemsettings` - Key-value configuration storage

**Files Involved:**

- [`MyApp/views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/MyApp/views.py) - Main admin views
- [`MyApp/sales_views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/MyApp/sales_views.py) - Sales management
- [`MyApp/salary_views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/MyApp/salary_views.py) - Salary processing
- [`MyApp/payment_views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/MyApp/payment_views.py) - Payment tracking
- [`MyApp/reports_views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/MyApp/reports_views.py) - Analytics

---

### **3. HOUSEHOLD WORKFLOW**

#### **3.1 Dashboard & Profile**

**URL Pattern:** `/household/` (HouseholdApp)

**Core Functions:**

- **Dashboard:** `GET /household/dashboard/` ‚Üí Overview of pickup requests and payments
- **Profile:** `GET /household/profile/` ‚Üí View household details
- **Edit Profile:** `GET/POST /household/profile/edit/` ‚Üí Update household information
- **Delete Account:** `POST /household/profile/delete/` ‚Üí Account deletion request

#### **3.2 Waste Pickup Request**

**Request Workflow:**

- **Request Pickup:** `GET/POST /household/request-pickup/` ‚Üí Schedule waste collection
- **AJAX Request:** `POST /household/request-pickup-ajax/` ‚Üí Asynchronous pickup request
- **View Requests:** `GET /household/my-requests/` ‚Üí List all pickup requests with status

**Pickup Request Process:**

1. Household submits pickup request
2. System identifies assigned collector based on:
   - Household's route (derived from house number)
   - Current day of week
   - Collector assignment
3. Creates `tbl_PickupRequest` with status "Pending"
4. Collector receives notification (email if configured)

**Pickup Request Fields:**

- Household (FK)
- Collector (assigned based on route/day)
- Estimated Weight (kg)
- Pickup Date
- Status (Pending/Approved/Rejected/Completed)
- Payment Method (UPI/Cash/Card)
- Payment Amount
- Transaction ID

**Database Table:**

- `myapp_tbl_pickuprequest`

#### **3.3 Payment Management**

**Payment Workflow:**

- **Make Payment:** `GET/POST /household/make-payment/` ‚Üí Pay monthly waste pickup fees
- **Payment History:** `GET /household/payment-history/` ‚Üí View past payments

**Payment Process:**

1. Select payment month
2. Choose payment method (UPI/Cash/Card)
3. Enter transaction details
4. System creates `tbl_HouseholdPayment` record
5. Payment status: Pending/Completed/Failed

**Database Table:**

- `myapp_tbl_householdpayment`

**Payment Fields:**

- Household (FK)
- Amount
- Payment Date
- Payment For Date (month being paid)
- Status
- Transaction ID

**Files Involved:**

- [`HouseholdApp/views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/HouseholdApp/views.py) - Household views
- [`HouseholdApp/forms.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/HouseholdApp/forms.py) - Household forms

---

### **4. COLLECTOR WORKFLOW**

#### **4.1 Dashboard & Profile**

**URL Pattern:** `/collector/` (CollectorApp)

**Core Functions:**

- **Dashboard:** `GET /collector/dashboard/` ‚Üí Overview of assigned pickups and collections
- **Profile:** `GET /collector/profile/` ‚Üí View collector details
- **Edit Profile:** `GET/POST /collector/profile/edit/` ‚Üí Update collector information
- **Delete Account:** `POST /collector/profile/delete/` ‚Üí Account deletion request

#### **4.2 Pickup Assignment & Collection**

**Assigned Pickups:**

- **View Assigned Pickups:** `GET /collector/assigned-pickups/` ‚Üí List today's scheduled pickups
- **Log Collection:** `GET/POST /collector/log-collection/<pickup_id>/` ‚Üí Record waste collection
- **AJAX Log Collection:** `POST /collector/log-collection-ajax/<pickup_id>/` ‚Üí Asynchronous collection logging

**Collection Logging Process:**

1. Collector visits household
2. Logs actual waste collected (kg)
3. Updates pickup request status to "Completed"
4. System creates `tbl_CollectionRequest` record
5. Creates `tbl_WasteInventory` entry for collected waste
6. Sends email notification to household (if configured)

**Collection Request Fields:**

- Household (FK)
- Collector (FK)
- Total Quantity (kg)
- Farmer Supply (kg allocated to farmers)
- Leftover Compost (kg sent to composting)
- Collection Date
- Status (Collected)

**Database Tables:**

- `myapp_tbl_collectionrequest` - Collection records
- `myapp_tbl_wasteinventory` - Collector's waste stock

#### **4.3 Waste Inventory Management**

**Inventory Tracking:**

- **View Inventory:** `GET /collector/waste-inventory/` ‚Üí Display current waste stock
- **Inventory Status:** Available/Sold/Expired

**Waste Inventory Fields:**

- Collector (FK)
- Collection Request (FK)
- Quantity Available (kg)
- Collection Date
- Expiry Date (calculated: collection_date + 30 days)
- Status (Available/Sold/Expired)
- Salary Paid (boolean)

**Database Table:**

- `myapp_tbl_wasteinventory`

**Automatic Status Updates:**

- Waste marked "Expired" after 30 days (configurable in system settings)
- Waste marked "Sold" when assigned to farmer order

#### **4.4 Sales Order Management**

**Sales Orders:**

- **View Sales Orders:** `GET /collector/sales-orders/` ‚Üí List assigned farmer orders
- **Update Delivery:** `POST /collector/update-delivery/<supply_id>/` ‚Üí Update delivery status

**Delivery Workflow:**

1. Admin assigns collector to farmer order
2. Collector receives notification
3. Collector delivers waste to farmer
4. Updates delivery status (Pending ‚Üí Delivered)
5. System updates inventory status to "Sold"

**Database Table:**

- `myapp_tbl_farmersupply` - Delivery assignments

#### **4.5 Collection History**

- **Collection History:** `GET /collector/history/` ‚Üí View all past collections with earnings

**Files Involved:**

- [`CollectorApp/views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/CollectorApp/views.py) - Collector views
- [`CollectorApp/forms.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/CollectorApp/forms.py) - Collector forms

---

### **5. COMPOST MANAGER WORKFLOW**

#### **5.1 Dashboard & Profile**

**URL Pattern:** `/compost-manager/` (CompostManagerApp)

**Core Functions:**

- **Dashboard:** `GET /compost-manager/dashboard/` ‚Üí Overview of batches and inventory
- **Profile:** `GET /compost-manager/profile/` ‚Üí View manager details
- **Edit Profile:** `GET/POST /compost-manager/profile/edit/` ‚Üí Update manager information
- **Delete Account:** `POST /compost-manager/profile/delete/` ‚Üí Account deletion request

#### **5.2 Waste Inventory**

**Inventory Management:**

- **View Waste Inventory:** `GET /compost-manager/waste-inventory/` ‚Üí Display available waste for composting

**Waste Sources:**

- Leftover waste from collector collections
- Waste not allocated to farmers
- Automatically available for composting

#### **5.3 Compost Batch Management**

**Batch Creation:**

- **Create Batch:** `GET/POST /compost-manager/create-batch/` ‚Üí Create new compost batch
- **Manage Batches:** `GET /compost-manager/manage-batches/` ‚Üí List all batches
- **Edit Batch:** `GET/POST /compost-manager/edit-batch/<batch_id>/` ‚Üí Modify batch details
- **Update Status:** `POST /compost-manager/update-batch/<batch_id>/` ‚Üí Change batch status

**Batch Creation Process:**

1. Select source waste (from available inventory)
2. Enter batch name
3. Specify source waste quantity (kg)
4. Select grade (Premium/A/B/C)
5. Set price per kg
6. System calculates compost output using conversion ratio (default: 4:1)
7. Creates `tbl_CompostBatch` with status "Processing"

**Batch Fields:**

- Batch Name (unique identifier)
- Source Waste (kg)
- Date Created
- Status (Processing/Ready/Sold)
- Grade (Premium/A/B/C)
- Stock (kg) - calculated from source waste
- Price Per Kg (‚Çπ)
- Compost Manager (FK)
- Salary Paid (boolean)

**Batch Statuses:**

- **Processing:** Composting in progress
- **Ready:** Available for sale
- **Sold:** Sold to farmers

**Database Table:**

- `myapp_tbl_compostbatch`

**Example Data:**

```sql
-- Batch "AA" created from 160kg waste
Batch_id=1, Batch_name='AA', Source_Waste_kg=160.00,
Stock_kg=40.00 (160/4), Grade='A', price_per_kg=200.00,
Status='Sold', salary_paid=1
```

**Files Involved:**

- [`CompostManagerApp/views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/CompostManagerApp/views.py) - Compost manager views
- [`CompostManagerApp/forms.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/CompostManagerApp/forms.py) - Compost manager forms

---

### **6. FARMER WORKFLOW**

#### **6.1 Dashboard & Profile**

**URL Pattern:** `/farmer/` (FarmerApp)

**Core Functions:**

- **Dashboard:** `GET /farmer/dashboard/` ‚Üí Overview of orders and purchases
- **Profile:** `GET /farmer/profile/` ‚Üí View farmer details
- **Edit Profile:** `GET/POST /farmer/profile/edit/` ‚Üí Update farmer information
- **Delete Account:** `POST /farmer/profile/delete/` ‚Üí Account deletion request

#### **6.2 Browse & Purchase**

**Product Browsing:**

- **Browse Waste:** `GET /farmer/browse-waste/` ‚Üí View available waste inventory
- **Browse Compost:** `GET /farmer/browse-compost/` ‚Üí View available compost batches

**Waste Inventory Display:**

- Collector name
- Quantity available (kg)
- Collection date
- Expiry date
- Price per kg
- Status (Available only)

**Compost Batch Display:**

- Batch name
- Grade (Premium/A/B/C)
- Stock available (kg)
- Price per kg
- Compost manager
- Status (Ready only)

#### **6.3 Order Placement**

**Order Workflow:**

- **Place Order:** `POST /farmer/place-order/` ‚Üí Create purchase order
- **View Orders:** `GET /farmer/orders/` ‚Üí List all orders with status

**Order Process:**

1. Farmer selects products (waste or compost)
2. Specifies quantity for each item
3. Chooses payment method (UPI/Cash/Card)
4. Enters delivery address
5. System creates `tbl_Order` and `tbl_OrderItem` records
6. Order status: Pending (awaiting admin assignment)

**Order Fields:**

- Farmer (FK)
- Order Date
- Total Amount (‚Çπ)
- Payment Method
- Payment Status (Pending/Completed)
- Delivery Address
- Delivery Status (Pending/Processing/Shipped/Delivered/Cancelled)

**Order Item Fields:**

- Order (FK)
- Product Type (Waste/Compost)
- Product ID (Inventory ID or Batch ID)
- Quantity (kg)
- Price Per Kg (‚Çπ)
- Total Price (‚Çπ)

**Database Tables:**

- `myapp_tbl_order` - Order headers
- `myapp_tbl_orderitem` - Order line items
- `myapp_tbl_farmersupply` - Delivery tracking (created by admin)

#### **6.4 Payment**

**Payment Processing:**

- **Make Payment:** `GET/POST /farmer/payment/` ‚Üí Pay for orders
- **Payment Methods:** UPI, Cash, Card

**Payment Workflow:**

1. Select pending order
2. Enter payment details
3. System creates `tbl_PaymentTransaction` record
4. Updates order payment status to "Completed"

**Files Involved:**

- [`FarmerApp/views.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/FarmerApp/views.py) - Farmer views

---

## üóÑÔ∏è Database Schema Overview

### **User Management Tables**

#### `guestapp_customuser` (Base User)

- **Primary Key:** `id`
- **Unique:** `email`
- **Fields:** name, email, phone, password, role, is_verified, is_active, account_status
- **Roles:** admin, household, collector, farmer, compost_manager

#### `guestapp_household`

- **Foreign Key:** `user_id` ‚Üí `guestapp_customuser`
- **Foreign Keys:** `district_id`, `location_id`, `residents_association_id`
- **Fields:** household_name, phone, address, aadhaar_image, house_no, registered_on

#### `guestapp_collector`

- **Foreign Key:** `user_id` ‚Üí `guestapp_customuser`
- **Fields:** collector_name, phone, address, license_image, is_active

#### `guestapp_farmer`

- **Foreign Key:** `user_id` ‚Üí `guestapp_customuser`
- **Fields:** farmer_name, phone, address, aadhaar_image, is_active

#### `guestapp_compostmanager`

- **Foreign Key:** `user_id` ‚Üí `guestapp_customuser`
- **Unique:** `license_number`
- **Fields:** compostmanager_name, phone, address, license_number, is_active

### **Location Tables**

#### `myapp_tbl_district`

- **Primary Key:** `District_id`
- **Fields:** District_Name

#### `myapp_tbl_location` (Wards)

- **Primary Key:** `Location_id`
- **Foreign Key:** `District` ‚Üí `myapp_tbl_district`
- **Fields:** Ward_No, Ward_Name

#### `myapp_tbl_residentsassociation`

- **Primary Key:** `RA_id`
- **Foreign Key:** `Location` ‚Üí `myapp_tbl_location`
- **Fields:** Association_Name

#### `myapp_tbl_route`

- **Primary Key:** `Route_id`
- **Foreign Key:** `location` ‚Üí `myapp_tbl_location`
- **Unique:** `name`
- **Fields:** name, start_house_no, end_house_no

### **Assignment Tables**

#### `myapp_tbl_collectorassignment`

- **Primary Key:** `Assign_id`
- **Foreign Keys:** `collector_id`, `Route_id_id`
- **Unique Together:** (collector, route, day_of_week)
- **Fields:** day_of_week

### **Waste Collection Tables**

#### `myapp_tbl_pickuprequest`

- **Primary Key:** `Request_id`
- **Foreign Keys:** `household_id`, `collector_id`
- **Fields:** estimated_weight_kg, pickup_date, status, payment_method, payment_amount, transaction_id

#### `myapp_tbl_collectionrequest`

- **Primary Key:** `Request_id`
- **Foreign Keys:** `household_id`, `collector_id`
- **Fields:** total_quantity_kg, farmer_supply_kg, leftover_compost_kg, collection_date, status

#### `myapp_tbl_wasteinventory`

- **Primary Key:** `Inventory_id`
- **Foreign Keys:** `collector_id`, `collection_id`
- **Fields:** quantity_available_kg, collection_date, expiry_date, status, salary_paid

### **Compost Tables**

#### `myapp_tbl_compostbatch`

- **Primary Key:** `Batch_id`
- **Foreign Key:** `CompostManager_id_id`
- **Fields:** Batch_name, Source_Waste_kg, Date_Created, Status, Grade, Stock_kg, price_per_kg, salary_paid

### **Order Tables**

#### `myapp_tbl_order`

- **Primary Key:** `Order_id`
- **Foreign Key:** `farmer_id`
- **Fields:** order_date, total_amount, payment_method, payment_status, delivery_address, delivery_status

#### `myapp_tbl_orderitem`

- **Primary Key:** `OrderItem_id`
- **Foreign Key:** `order_id`
- **Fields:** product_type, product_id, quantity_kg, price_per_kg, total_price

#### `myapp_tbl_farmersupply`

- **Primary Key:** `Supply_id`
- **Foreign Keys:** `order_id`, `collector_id`, `Collection_id` (optional)
- **Fields:** quantity_kg, delivery_status, delivery_date

### **Payment Tables**

#### `myapp_tbl_householdpayment`

- **Primary Key:** `Payment_id`
- **Foreign Key:** `household_id`
- **Fields:** amount, payment_date, payment_for_date, status, transaction_id

#### `myapp_tbl_paymenttransaction`

- **Primary Key:** `Transaction_id`
- **Fields:** transaction_type, amount, payment_method, transaction_date, user_id, user_type, transaction_id

### **Configuration Tables**

#### `myapp_tbl_bintype`

- **Primary Key:** `BinType_id`
- **Fields:** name, capacity_kg, price_rs

#### `myapp_systemsettings`

- **Primary Key:** `setting_key`
- **Fields:** setting_value, description, last_updated

---

## üìß Email System

### **Configuration**

**File:** [`EMAIL_SETUP.md`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/EMAIL_SETUP.md)

### **Current Status**

- **Development Mode:** Console backend (emails printed to terminal)
- **Production Mode:** SMTP backend (requires Gmail app password)

### **Email Triggers**

1. **Household Notifications:**
   - Pickup request confirmation
   - Collection completion
   - Payment confirmation

2. **Collector Notifications:**
   - New pickup assignment
   - Delivery assignment

3. **Admin Notifications:**
   - New user registration
   - Payment received

### **Email Templates**

- Location: `templates/emails/`
- Base template: `templates/emails/base_email.html`
- Household templates: `templates/emails/household/`
- Collector templates: `templates/emails/collector/`

### **Production Setup**

```powershell
# Set environment variables
$env:EMAIL_HOST_USER = "your-gmail@gmail.com"
$env:EMAIL_HOST_PASSWORD = "your-app-password"
```

---

## üîê Authentication & Authorization

### **User Roles & Permissions**

| Role                | Access Level       | Dashboard URL                 | Key Features                                     |
| ------------------- | ------------------ | ----------------------------- | ------------------------------------------------ |
| **Admin**           | Full system access | `/admin/`                     | User management, reports, settings, assignments  |
| **Household**       | Own data only      | `/household/dashboard/`       | Request pickup, make payments, view history      |
| **Collector**       | Assigned routes    | `/collector/dashboard/`       | Log collections, manage inventory, view earnings |
| **Farmer**          | Marketplace access | `/farmer/dashboard/`          | Browse products, place orders, make payments     |
| **Compost Manager** | Batch management   | `/compost-manager/dashboard/` | Create batches, manage inventory, view earnings  |

### **Decorators**

**File:** [`MyApp/decorators.py`](file:///d:/All%20Projectssss/Main%20Project/BioBinConnect/MyProject/MyApp/decorators.py)

**Custom Decorators:**

- `@admin_required` - Restrict to admin users
- `@household_required` - Restrict to household users
- `@collector_required` - Restrict to collector users
- `@farmer_required` - Restrict to farmer users
- `@compost_manager_required` - Restrict to compost manager users

---

## üí∞ Financial Workflow

### **Revenue Streams**

1. **Household Payments:** Monthly waste pickup fees
2. **Farmer Purchases:** Waste and compost sales

### **Expense Streams**

1. **Collector Salaries:** ‚Çπ5/kg collected
2. **Compost Manager Salaries:** ‚Çπ10/kg produced

### **Payment Methods**

- UPI
- Cash
- Card

### **Transaction Tracking**

All financial transactions recorded in `myapp_tbl_paymenttransaction`:

- Household Payment
- Farmer Payment
- Collector Salary
- Manager Salary
- COD (Cash on Delivery)

---

## üìä Current System Statistics

### **Users (as of Jan 21, 2026)**

- **Total Users:** 27
- **Households:** 13
- **Collectors:** 6
- **Farmers:** 4
- **Compost Managers:** 2
- **Admins:** 1

### **Locations**

- **Districts:** 1 (Idukki)
- **Locations/Wards:** Multiple
- **Residents Associations:** Multiple
- **Routes:** 6

### **Collections**

- **Total Collection Requests:** 56
- **Status:** All "Collected"
- **Total Waste Collected:** ~2,500+ kg

### **Compost Batches**

- **Total Batches:** 8
- **Total Source Waste:** 1,454 kg
- **Total Compost Produced:** ~363.5 kg (4:1 ratio)
- **Batches Sold:** 7
- **Batches Ready:** 1

### **Bin Types**

- Large: 50kg @ ‚Çπ100
- Medium: 25kg @ ‚Çπ50

### **System Settings**

- Compost Conversion Ratio: 4:1
- Low Stock Threshold: 50kg
- Expiry Warning: 7 days
- Auto Unavailable: 30 days
- Waste Price: ‚Çπ10/kg

---

## üîÑ Complete User Journey Examples

### **Example 1: Household Waste Collection**

1. **Registration:**
   - Household registers at `/signup/`
   - Provides: Name, Email, Phone, Address, Aadhaar, House #1, District: Idukki, Location: Ward 1, RA: Association 1
   - Account created with status "Pending"

2. **Admin Approval:**
   - Admin views pending users at `/admin/view_users/`
   - Approves household account
   - Account status: "Approved"

3. **Route Assignment:**
   - Admin creates route "Route 1" for Ward 1, House #1-10
   - Assigns Collector #1 to Route 1 for Monday-Sunday

4. **Pickup Request:**
   - Household logs in, goes to `/household/request-pickup/`
   - Submits pickup request for 50kg
   - System assigns Collector #1 (based on route and day)
   - Request status: "Pending"

5. **Collection:**
   - Collector logs in, views assigned pickups at `/collector/assigned-pickups/`
   - Visits household, logs collection of 48kg at `/collector/log-collection/<pickup_id>/`
   - System creates:
     - `tbl_CollectionRequest` (48kg collected)
     - `tbl_WasteInventory` (48kg available)
   - Pickup status: "Completed"
   - Email sent to household (if configured)

6. **Payment:**
   - Household makes monthly payment at `/household/make-payment/`
   - Pays ‚Çπ100 via UPI
   - System creates `tbl_HouseholdPayment` record
   - Payment status: "Completed"

### **Example 2: Waste to Compost to Farmer**

1. **Waste Collection:**
   - Collector collects 160kg waste from multiple households
   - 160kg added to `tbl_WasteInventory`

2. **Compost Batch Creation:**
   - Compost Manager logs in, goes to `/compost-manager/create-batch/`
   - Creates batch "AA" from 160kg waste
   - Grade: A, Price: ‚Çπ200/kg
   - System calculates: 160kg √∑ 4 = 40kg compost
   - Batch status: "Processing"

3. **Batch Ready:**
   - Manager updates batch status to "Ready" at `/compost-manager/update-batch/<batch_id>/`
   - 40kg compost now available for sale

4. **Farmer Purchase:**
   - Farmer browses compost at `/farmer/browse-compost/`
   - Sees batch "AA": 40kg @ ‚Çπ200/kg
   - Places order for 40kg (Total: ‚Çπ8,000)
   - Order status: "Pending"

5. **Admin Processing:**
   - Admin views order at `/admin/compost-sales/`
   - Updates delivery status to "Delivered"
   - Batch status: "Sold"
   - Batch stock: 0kg

6. **Farmer Payment:**
   - Farmer makes payment at `/farmer/payment/`
   - Pays ‚Çπ8,000 via UPI
   - System creates `tbl_PaymentTransaction` record
   - Order payment status: "Completed"

7. **Salary Payment:**
   - Admin goes to `/admin/salaries/`
   - Sees Compost Manager earned ‚Çπ400 (40kg √ó ‚Çπ10)
   - Pays salary
   - System creates `tbl_PaymentTransaction` record
   - Batch `salary_paid` flag: True

### **Example 3: Direct Waste Sale to Farmer**

1. **Waste Collection:**
   - Collector collects 50kg waste
   - Added to `tbl_WasteInventory` with status "Available"

2. **Farmer Purchase:**
   - Farmer browses waste at `/farmer/browse-waste/`
   - Sees 50kg available @ ‚Çπ10/kg
   - Places order for 50kg (Total: ‚Çπ500)
   - Order status: "Pending"

3. **Admin Assignment:**
   - Admin views order at `/admin/waste-sales/`
   - Assigns Collector to deliver order
   - System creates `tbl_FarmerSupply` record
   - Links order to collector's inventory

4. **Collector Delivery:**
   - Collector views order at `/collector/sales-orders/`
   - Delivers waste to farmer
   - Updates delivery status to "Delivered"
   - Inventory status: "Sold"

5. **Farmer Payment:**
   - Farmer pays ‚Çπ500
   - System creates `tbl_PaymentTransaction` record

6. **Collector Salary:**
   - Admin pays collector ‚Çπ250 (50kg √ó ‚Çπ5)
   - System creates `tbl_PaymentTransaction` record
   - Inventory `salary_paid` flag: True

---

## üõ†Ô∏è Technical Implementation Details

### **Django Apps Structure**

```
MyProject/
‚îú‚îÄ‚îÄ MyApp/                  # Admin panel
‚îÇ   ‚îú‚îÄ‚îÄ views.py           # Main admin views
‚îÇ   ‚îú‚îÄ‚îÄ sales_views.py     # Sales management
‚îÇ   ‚îú‚îÄ‚îÄ salary_views.py    # Salary processing
‚îÇ   ‚îú‚îÄ‚îÄ payment_views.py   # Payment tracking
‚îÇ   ‚îú‚îÄ‚îÄ reports_views.py   # Analytics
‚îÇ   ‚îú‚îÄ‚îÄ forms.py           # Admin forms
‚îÇ   ‚îú‚îÄ‚îÄ models.py          # Core models
‚îÇ   ‚îú‚îÄ‚îÄ decorators.py      # Auth decorators
‚îÇ   ‚îî‚îÄ‚îÄ utils.py           # Helper functions
‚îÇ
‚îú‚îÄ‚îÄ GuestApp/              # Public & auth
‚îÇ   ‚îú‚îÄ‚îÄ views.py           # Auth views
‚îÇ   ‚îú‚îÄ‚îÄ api_views.py       # AJAX endpoints
‚îÇ   ‚îú‚îÄ‚îÄ forms.py           # Registration forms
‚îÇ   ‚îî‚îÄ‚îÄ models.py          # User models
‚îÇ
‚îú‚îÄ‚îÄ HouseholdApp/          # Household portal
‚îÇ   ‚îú‚îÄ‚îÄ views.py           # Household views
‚îÇ   ‚îî‚îÄ‚îÄ forms.py           # Household forms
‚îÇ
‚îú‚îÄ‚îÄ CollectorApp/          # Collector portal
‚îÇ   ‚îú‚îÄ‚îÄ views.py           # Collector views
‚îÇ   ‚îî‚îÄ‚îÄ forms.py           # Collector forms
‚îÇ
‚îú‚îÄ‚îÄ FarmerApp/             # Farmer portal
‚îÇ   ‚îî‚îÄ‚îÄ views.py           # Farmer views
‚îÇ
‚îî‚îÄ‚îÄ CompostManagerApp/     # Manager portal
    ‚îú‚îÄ‚îÄ views.py           # Manager views
    ‚îî‚îÄ‚îÄ forms.py           # Manager forms
```

### **URL Routing**

```python
# Main URLs (MyProject/urls.py)
/                          ‚Üí GuestApp
/admin/                    ‚Üí MyApp (Admin Panel)
/household/                ‚Üí HouseholdApp
/collector/                ‚Üí CollectorApp
/farmer/                   ‚Üí FarmerApp
/compost-manager/          ‚Üí CompostManagerApp
```

### **Key Features**

1. **AJAX Validation:**
   - House number uniqueness check
   - Real-time form validation
   - Asynchronous pickup requests

2. **Email Notifications:**
   - Graceful fallback to console backend
   - Production-ready SMTP configuration
   - Template-based emails

3. **Salary Automation:**
   - Automatic calculation based on work done
   - Prevents duplicate payments with `salary_paid` flags
   - Transaction tracking for audit trail

4. **Inventory Management:**
   - Automatic expiry tracking
   - Status updates (Available/Sold/Expired)
   - Stock level monitoring

5. **Payment Tracking:**
   - Multiple payment methods
   - Transaction ID recording
   - Revenue analytics

6. **System Configuration:**
   - Database-driven settings
   - No code changes required for parameter updates
   - Audit trail with last_updated timestamps

---

## üö® Known Issues & Considerations

### **Email System**

- Currently in development mode (console backend)
- Requires Gmail app password for production
- Email failures don't block workflow

### **Inventory Management**

- `Collection_id` in `tbl_FarmerSupply` is optional (migration 0006)
- Allows direct waste sales without collection reference

### **Salary Payments**

- Manual admin approval required
- No automatic payment processing
- Relies on `salary_paid` flags to prevent duplicates

### **Order Fulfillment**

- Admin must manually assign collectors to farmer orders
- No automatic collector selection based on inventory

### **Data Validation**

- House number uniqueness enforced at database level
- Route assignment requires manual configuration
- No automatic route generation

---

## üìà Workflow Optimization Recommendations

### **1. Automated Collector Assignment**

- Implement automatic collector assignment for farmer orders based on:
  - Available inventory
  - Proximity to farmer
  - Collector workload

### **2. Email Reliability**

- Configure production SMTP credentials
- Implement email queue for retry logic
- Add email delivery status tracking

### **3. Payment Automation**

- Integrate payment gateway (Razorpay/Stripe)
- Automate salary disbursement
- Implement automatic payment reminders

### **4. Inventory Alerts**

- Email notifications for low stock
- Expiry warnings for collectors
- Automatic status updates

### **5. Route Optimization**

- Implement route planning algorithm
- Optimize collector assignments based on distance
- Dynamic route adjustment

### **6. Reporting Enhancements**

- Real-time dashboard metrics
- Export functionality for all reports
- Scheduled report generation

### **7. Mobile Optimization**

- Responsive design improvements
- Mobile app for collectors (GPS tracking)
- Push notifications

---

## üìù Conclusion

BioBinConnect is a comprehensive waste management ecosystem with well-defined workflows for all stakeholders. The system successfully connects households, collectors, compost managers, and farmers in a circular economy model with integrated payment tracking and inventory management.

### **Strengths:**

‚úÖ Clear role-based access control  
‚úÖ Complete waste-to-compost-to-farmer lifecycle  
‚úÖ Integrated payment and salary management  
‚úÖ Flexible system configuration  
‚úÖ Email notification system with fallback  
‚úÖ Comprehensive audit trail

### **Areas for Enhancement:**

üîß Automate collector assignment for farmer orders  
üîß Implement payment gateway integration  
üîß Add real-time inventory alerts  
üîß Optimize route planning  
üîß Enhance mobile responsiveness  
üîß Add analytics dashboard

---

**Report Generated:** January 22, 2026, 06:40 AM IST  
**Total Database Tables:** 26  
**Total URL Endpoints:** 70+  
**Total User Roles:** 5  
**Active Users:** 27  
**Total Collections:** 56  
**Total Compost Batches:** 8
